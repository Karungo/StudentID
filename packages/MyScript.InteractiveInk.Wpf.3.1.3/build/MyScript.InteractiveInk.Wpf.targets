<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Target Name="PlatformCheck" BeforeTargets="BuildOnlySettings" Condition="('$(Platform)' != 'x64')">
    <Error  Text="You need to specify platform x64." />
  </Target>

  <Target Name="InjectReference" BeforeTargets="ResolveAssemblyReferences">
    <ItemGroup>
      <Reference Include="MyScript.IInk">
        <HintPath>$(MSBuildThisFileDirectory)..\lib\net48\x64\MyScript.IInk.dll</HintPath>
      </Reference>
    </ItemGroup>
  </Target>

  <ItemGroup>
    <NativeLibs Include="$(MSBuildThisFileDirectory)x64\*.dll" />
    <None Include="@(NativeLibs)">
      <Link>%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>
</Project>